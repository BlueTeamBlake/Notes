# 🧠 Forensic Triage Map

A structured approach to threat hunting, memory forensics, and post-incident analysis.

---

## 🔓 1. Initial Access

**Where to Look:**
- `Event ID 4624`, `4625`, `4776`, `4768` – Login attempts
- Email attachments, browser downloads
- Office macro execution (`Event ID 4104`)
- Attachment/URL scanning: [VirusTotal](https://www.virustotal.com), [URLScan](https://urlscan.io), [Abuse.ch](https://abuse.ch)

---

## ⚙️ 2. Execution

**Where to Look:**
- `.pf` Prefetch files
- PowerShell logs: `4103`, `4104`, `4105`, `4106`
- Scheduled Tasks: `Event ID 4698`, `19`, `20`
- Command line logging: `4688` (with arguments)
- AMSI logs (script-based detection)

---

## 🧬 3. Persistence

**Where to Look:**
- Registry autoruns:
  - `HKCU\Software\Microsoft\Windows\CurrentVersion\Run`
  - `HKLM\Software\Microsoft\Windows\CurrentVersion\Run`
- `Startup` folder contents
- Scheduled Tasks & Services
- WMI persistence (WMI Consumers/Filters)
- Volatility: `svcscan`, `autoruns`

---

## 📡 4. Command & Control

**Where to Look:**
- `netstat`, `tcpview`, `Wireshark`, or Volatility `netscan`
- DNS cache or `Sysmon Event ID 22`
- Memory strings: `User-Agent`, `/gate.php`, base64 blobs
- Volatility plugins: `malfind`, `connscan`, `psxview`

---

## 📦 5. Exfiltration / Lateral Movement

**Where to Look:**
- File access logs / audit logs
- PowerShell commands: `Invoke-Command`, `PsExec`, `WinRM`
- `Event ID 4624` (LogonType 10 - RDP)
- SMB share usage: `Event ID 5140`
- Unusual `.zip`, `.rar`, or `.7z` archives created

---

## 💣 6. Impact

**Where to Look:**
- File extension changes
- Ransom notes (`README.txt`, etc.)
- Deletion of shadow copies (`vssadmin`, `wmic`)
- Volatility: `filescan`, `cmdline`, `mutantscan`
- Indicators of data wiping (`sdelete`, logs purged)

---

## 🧰 Tools

| Type              | Tool                                | Purpose                         |
|-------------------|-------------------------------------|---------------------------------|
| Memory Forensics  | Volatility                          | Analyze RAM dumps               |
| Disk Forensics    | Autopsy, FTK Imager                 | Investigate disk artifacts      |
| Rapid Triage      | KAPE, Velociraptor, EZ Tools        | Fast log/artifact collection    |
| Registry Parsing  | RegRipper, RECmd                    | Extract persistence indicators  |
| Threat Intelligence| VirusTotal, Abuse.ch, Hybrid Analysis | IOC validation               |
| Log Correlation   | Splunk, Elastic, Event Viewer       | Cross-source log analysis       |

---

> _"Digital forensics is less about the tools, more about knowing where the attacker leaves fingerprints."_ 🕵️‍♂️

